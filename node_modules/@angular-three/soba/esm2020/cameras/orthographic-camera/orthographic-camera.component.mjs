var _NgtSobaOrthographicCameraStore_projectMatrixParams$, _NgtSobaOrthographicCameraStore_cameraParams$;
import { __classPrivateFieldGet } from "tslib";
import { EnhancedRxState, NGT_OBJECT_INPUTS_CONTROLLER_PROVIDER, NGT_OBJECT_INPUTS_WATCHED_CONTROLLER, NgtObject3dInputsController, NgtObject3dInputsControllerModule, NgtSobaExtender, NgtStore, } from '@angular-three/core';
import { NgtOrthographicCameraModule } from '@angular-three/core/cameras';
import { CommonModule } from '@angular/common';
import { ChangeDetectionStrategy, Component, Inject, Injectable, Input, NgModule, } from '@angular/core';
import { selectSlice } from '@rx-angular/state';
import { combineLatest, map, of, startWith } from 'rxjs';
import * as i0 from "@angular/core";
import * as i1 from "@angular-three/core";
import * as i2 from "@angular/common";
import * as i3 from "@angular-three/core/cameras";
export class NgtSobaOrthographicCameraStore extends EnhancedRxState {
    constructor(store, objectInputsController) {
        super();
        this.store = store;
        this.objectInputsController = objectInputsController;
        _NgtSobaOrthographicCameraStore_projectMatrixParams$.set(this, combineLatest([
            this.store.select('size'),
            this.select(selectSlice(['near', 'far'])),
            this.objectInputsController.change$.pipe(startWith({})),
        ]).pipe(map(([size, { near, far }]) => ({ size, near, far }))));
        _NgtSobaOrthographicCameraStore_cameraParams$.set(this, combineLatest([
            this.store.select('camera'),
            this.select(selectSlice(['orthographicCamera', 'makeDefault'])),
        ]).pipe(map(([camera, { orthographicCamera, makeDefault }]) => ({
            camera,
            orthographicCamera,
            makeDefault,
        }))));
        this.vm$ = combineLatest([
            of(this.objectInputsController),
            this.store.select('size'),
            this.select(selectSlice(['near', 'far']), startWith({ near: undefined, far: undefined })),
        ]).pipe(map(([objectInputsController, size, { near, far }]) => ({
            left: size.width / -2,
            right: size.width / 2,
            top: size.height / 2,
            bottom: size.height / -2,
            objectInputsController,
            near,
            far,
        })));
        this.hold(__classPrivateFieldGet(this, _NgtSobaOrthographicCameraStore_projectMatrixParams$, "f"), () => {
            const { manual, orthographicCamera } = this.get();
            if (orthographicCamera && !manual) {
                orthographicCamera.updateProjectionMatrix();
            }
        });
        this.holdEffect(__classPrivateFieldGet(this, _NgtSobaOrthographicCameraStore_cameraParams$, "f"), ({ camera, orthographicCamera, makeDefault }) => {
            if (makeDefault && orthographicCamera) {
                this.store.set({ camera: orthographicCamera });
            }
            return () => {
                this.store.set({ camera });
            };
        });
    }
}
_NgtSobaOrthographicCameraStore_projectMatrixParams$ = new WeakMap(), _NgtSobaOrthographicCameraStore_cameraParams$ = new WeakMap();
NgtSobaOrthographicCameraStore.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCameraStore, deps: [{ token: i1.NgtStore }, { token: NGT_OBJECT_INPUTS_WATCHED_CONTROLLER }], target: i0.ɵɵFactoryTarget.Injectable });
NgtSobaOrthographicCameraStore.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCameraStore });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCameraStore, decorators: [{
            type: Injectable
        }], ctorParameters: function () { return [{ type: i1.NgtStore }, { type: i1.NgtObject3dInputsController, decorators: [{
                    type: Inject,
                    args: [NGT_OBJECT_INPUTS_WATCHED_CONTROLLER]
                }] }]; } });
export class NgtSobaOrthographicCamera extends NgtSobaExtender {
    constructor(sobaOrthographicCameraStore) {
        super();
        this.sobaOrthographicCameraStore = sobaOrthographicCameraStore;
        this.vm$ = this.sobaOrthographicCameraStore.vm$;
    }
    set makeDefault(makeDefault) {
        this.sobaOrthographicCameraStore.set({ makeDefault });
    }
    set manual(manual) {
        this.sobaOrthographicCameraStore.set({ manual });
    }
    set near(near) {
        this.sobaOrthographicCameraStore.set({ near });
    }
    set far(far) {
        this.sobaOrthographicCameraStore.set({ far });
    }
}
NgtSobaOrthographicCamera.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCamera, deps: [{ token: NgtSobaOrthographicCameraStore }], target: i0.ɵɵFactoryTarget.Component });
NgtSobaOrthographicCamera.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.1", type: NgtSobaOrthographicCamera, selector: "ngt-soba-orthographic-camera", inputs: { makeDefault: "makeDefault", manual: "manual", near: "near", far: "far" }, providers: [
        NGT_OBJECT_INPUTS_CONTROLLER_PROVIDER,
        NgtSobaOrthographicCameraStore,
        { provide: NgtSobaExtender, useExisting: NgtSobaOrthographicCamera },
    ], usesInheritance: true, ngImport: i0, template: `
    <ngt-orthographic-camera
      *ngIf="vm$ | async as vm"
      [args]="[vm.left, vm.right, vm.top, vm.bottom, vm.near, vm.far]"
      [object3dInputsController]="vm.objectInputsController"
      (ready)="object = $event"
    >
      <ng-content></ng-content>
    </ngt-orthographic-camera>
  `, isInline: true, directives: [{ type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i3.NgtOrthographicCamera, selector: "ngt-orthographic-camera", inputs: ["args"], exportAs: ["ngtOrthographicCamera"] }, { type: i1.NgtObject3dController, selector: "    ngt-primitive,    ngt-bone,    ngt-group,    ngt-lod,    ngt-points,    ngt-mesh,    ngt-instanced-mesh,    ngt-skinned-mesh,    ngt-audio,    ngt-positional-audio,    ngt-line,    ngt-line-loop,    ngt-line-segments,    ngt-light-probe,    ngt-ambient-light,    ngt-ambient-light-probe,    ngt-hemisphere-light,    ngt-hemisphere-light-probe,    ngt-directional-light,    ngt-point-light,    ngt-spot-light,    ngt-rect-area-light,    ngt-arrow-helper,    ngt-axes-helper,    ngt-box3-helper,    ngt-grid-helper,    ngt-plane-helper,    ngt-polar-grid-helper,    ngt-sprite,    ngt-camera,    ngt-perspective-camera,    ngt-orthographic-camera,    ngt-array-camera,    ngt-stereo-camera,    ngt-cube-camera  ", exportAs: ["ngtObject3dController"] }, { type: i1.NgtObject3dInputsController, selector: "    ngt-primitive,    ngt-bone,    ngt-group,    ngt-lod,    ngt-points,    ngt-mesh,    ngt-instanced-mesh,    ngt-skinned-mesh,    ngt-audio,    ngt-positional-audio,    ngt-line,    ngt-line-loop,    ngt-line-segments,    ngt-light-probe,    ngt-ambient-light,    ngt-ambient-light-probe,    ngt-hemisphere-light,    ngt-hemisphere-light-probe,    ngt-directional-light,    ngt-point-light,    ngt-spot-light,    ngt-rect-area-light,    ngt-arrow-helper,    ngt-axes-helper,    ngt-box3-helper,    ngt-grid-helper,    ngt-plane-helper,    ngt-polar-grid-helper,    ngt-sprite,    ngt-camera,    ngt-perspective-camera,    ngt-orthographic-camera,    ngt-array-camera,    ngt-stereo-camera,    ngt-cube-camera,    ngt-soba-plane,    ngt-soba-box,    ngt-soba-cylinder,    ngt-soba-cone,    ngt-soba-circle,    ngt-soba-sphere,    ngt-soba-tube,    ngt-soba-torus,    ngt-soba-tetrahedron,    ngt-soba-ring,    ngt-soba-polyhedron,    ngt-soba-octahedron,    ngt-soba-dodecahedron,    ngt-soba-icosahedron,    ngt-soba-extrude,    ngt-soba-lathe,    ngt-soba-torus-knot,    ngt-soba-billboard,    ngt-soba-detailed,    ngt-soba-line,    ngt-soba-quadratic-bezier-line,    ngt-soba-cubic-bezier-line,    ngt-soba-orthographic-camera,    ngt-soba-gizmo-helper,    ngt-soba-gizmo-viewport,    ngt-soba-gizmo-axis-head,    ngt-soba-text  ", inputs: ["name", "position", "rotation", "quaternion", "scale", "color", "userData", "castShadow", "receiveShadow", "visible", "matrixAutoUpdate", "dispose", "raycast", "appendMode", "appendTo", "object3dInputsController"], outputs: ["click", "contextmenu", "dblclick", "pointerup", "pointerdown", "pointerover", "pointerout", "pointerenter", "pointerleave", "pointermove", "pointermissed", "pointercancel", "wheel"], exportAs: ["ngtObject3dInputsController"] }], pipes: { "async": i2.AsyncPipe }, changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCamera, decorators: [{
            type: Component,
            args: [{
                    selector: 'ngt-soba-orthographic-camera',
                    template: `
    <ngt-orthographic-camera
      *ngIf="vm$ | async as vm"
      [args]="[vm.left, vm.right, vm.top, vm.bottom, vm.near, vm.far]"
      [object3dInputsController]="vm.objectInputsController"
      (ready)="object = $event"
    >
      <ng-content></ng-content>
    </ngt-orthographic-camera>
  `,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    providers: [
                        NGT_OBJECT_INPUTS_CONTROLLER_PROVIDER,
                        NgtSobaOrthographicCameraStore,
                        { provide: NgtSobaExtender, useExisting: NgtSobaOrthographicCamera },
                    ],
                }]
        }], ctorParameters: function () { return [{ type: NgtSobaOrthographicCameraStore }]; }, propDecorators: { makeDefault: [{
                type: Input
            }], manual: [{
                type: Input
            }], near: [{
                type: Input
            }], far: [{
                type: Input
            }] } });
export class NgtSobaOrthographicCameraModule {
}
NgtSobaOrthographicCameraModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCameraModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });
NgtSobaOrthographicCameraModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCameraModule, declarations: [NgtSobaOrthographicCamera], imports: [CommonModule, NgtOrthographicCameraModule], exports: [NgtSobaOrthographicCamera, NgtObject3dInputsControllerModule] });
NgtSobaOrthographicCameraModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCameraModule, imports: [[CommonModule, NgtOrthographicCameraModule], NgtObject3dInputsControllerModule] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaOrthographicCameraModule, decorators: [{
            type: NgModule,
            args: [{
                    declarations: [NgtSobaOrthographicCamera],
                    exports: [NgtSobaOrthographicCamera, NgtObject3dInputsControllerModule],
                    imports: [CommonModule, NgtOrthographicCameraModule],
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3J0aG9ncmFwaGljLWNhbWVyYS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9zb2JhL2NhbWVyYXMvc3JjL29ydGhvZ3JhcGhpYy1jYW1lcmEvb3J0aG9ncmFwaGljLWNhbWVyYS5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLEVBQ0wsZUFBZSxFQUNmLHFDQUFxQyxFQUNyQyxvQ0FBb0MsRUFDcEMsMkJBQTJCLEVBQzNCLGlDQUFpQyxFQUNqQyxlQUFlLEVBQ2YsUUFBUSxHQUNULE1BQU0scUJBQXFCLENBQUM7QUFDN0IsT0FBTyxFQUFFLDJCQUEyQixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFDMUUsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQy9DLE9BQU8sRUFDTCx1QkFBdUIsRUFDdkIsU0FBUyxFQUNULE1BQU0sRUFDTixVQUFVLEVBQ1YsS0FBSyxFQUNMLFFBQVEsR0FDVCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsV0FBVyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDaEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxHQUFHLEVBQWMsRUFBRSxFQUFFLFNBQVMsRUFBRSxNQUFNLE1BQU0sQ0FBQzs7Ozs7QUFZckUsTUFBTSxPQUFPLDhCQUErQixTQUFRLGVBQStDO0lBNkNqRyxZQUNVLEtBQWUsRUFFZixzQkFBbUQ7UUFFM0QsS0FBSyxFQUFFLENBQUM7UUFKQSxVQUFLLEdBQUwsS0FBSyxDQUFVO1FBRWYsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUE2QjtRQS9DN0QsK0RBQWlDLGFBQWEsQ0FBQztZQUM3QyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUM7WUFDekIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FB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TyxFQUFFLGVBQWUsRUFBRSxXQUFXLDJCQUEyQixFQUFFO3FCQUNyRTtpQkFDRjswREFxQndDLDhCQUE4QiwwQkFuQnhELFdBQVc7c0JBQXZCLEtBQUs7Z0JBSU8sTUFBTTtzQkFBbEIsS0FBSztnQkFJTyxJQUFJO3NCQUFoQixLQUFLO2dCQUlPLEdBQUc7c0JBQWYsS0FBSzs7QUFrQlIsTUFBTSxPQUFPLCtCQUErQjs7NEhBQS9CLCtCQUErQjs2SEFBL0IsK0JBQStCLGlCQS9CL0IseUJBQXlCLGFBNkIxQixZQUFZLEVBQUUsMkJBQTJCLGFBN0J4Qyx5QkFBeUIsRUE0QkMsaUNBQWlDOzZIQUczRCwrQkFBK0IsWUFGakMsQ0FBQyxZQUFZLEVBQUUsMkJBQTJCLENBQUMsRUFEZixpQ0FBaUM7MkZBRzNELCtCQUErQjtrQkFMM0MsUUFBUTttQkFBQztvQkFDUixZQUFZLEVBQUUsQ0FBQyx5QkFBeUIsQ0FBQztvQkFDekMsT0FBTyxFQUFFLENBQUMseUJBQXlCLEVBQUUsaUNBQWlDLENBQUM7b0JBQ3ZFLE9BQU8sRUFBRSxDQUFDLFlBQVksRUFBRSwyQkFBMkIsQ0FBQztpQkFDckQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBFbmhhbmNlZFJ4U3RhdGUsXG4gIE5HVF9PQkpFQ1RfSU5QVVRTX0NPTlRST0xMRVJfUFJPVklERVIsXG4gIE5HVF9PQkpFQ1RfSU5QVVRTX1dBVENIRURfQ09OVFJPTExFUixcbiAgTmd0T2JqZWN0M2RJbnB1dHNDb250cm9sbGVyLFxuICBOZ3RPYmplY3QzZElucHV0c0NvbnRyb2xsZXJNb2R1bGUsXG4gIE5ndFNvYmFFeHRlbmRlcixcbiAgTmd0U3RvcmUsXG59IGZyb20gJ0Bhbmd1bGFyLXRocmVlL2NvcmUnO1xuaW1wb3J0IHsgTmd0T3J0aG9ncmFwaGljQ2FtZXJhTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXItdGhyZWUvY29yZS9jYW1lcmFzJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBJbmplY3QsXG4gIEluamVjdGFibGUsXG4gIElucHV0LFxuICBOZ01vZHVsZSxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBzZWxlY3RTbGljZSB9IGZyb20gJ0ByeC1hbmd1bGFyL3N0YXRlJztcbmltcG9ydCB7IGNvbWJpbmVMYXRlc3QsIG1hcCwgT2JzZXJ2YWJsZSwgb2YsIHN0YXJ0V2l0aCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIE5ndFNvYmFPcnRob2dyYXBoaWNDYW1lcmFTdGF0ZSB7XG4gIG1ha2VEZWZhdWx0PzogYm9vbGVhbjtcbiAgbWFudWFsPzogYm9vbGVhbjtcbiAgbmVhcj86IG51bWJlcjtcbiAgZmFyPzogbnVtYmVyO1xuICBvcnRob2dyYXBoaWNDYW1lcmE/OiBUSFJFRS5PcnRob2dyYXBoaWNDYW1lcmE7XG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBOZ3RTb2JhT3J0aG9ncmFwaGljQ2FtZXJhU3RvcmUgZXh0ZW5kcyBFbmhhbmNlZFJ4U3RhdGU8Tmd0U29iYU9ydGhvZ3JhcGhpY0NhbWVyYVN0YXRlPiB7XG4gIHJlYWRvbmx5ICNwcm9qZWN0TWF0cml4UGFyYW1zJCA9IGNvbWJpbmVMYXRlc3QoW1xuICAgIHRoaXMuc3RvcmUuc2VsZWN0KCdzaXplJyksXG4gICAgdGhpcy5zZWxlY3Qoc2VsZWN0U2xpY2UoWyduZWFyJywgJ2ZhciddKSksXG4gICAgdGhpcy5vYmplY3RJbnB1dHNDb250cm9sbGVyLmNoYW5nZSQucGlwZShzdGFydFdpdGgoe30pKSxcbiAgXSkucGlwZShtYXAoKFtzaXplLCB7IG5lYXIsIGZhciB9XSkgPT4gKHsgc2l6ZSwgbmVhciwgZmFyIH0pKSk7XG5cbiAgcmVhZG9ubHkgI2NhbWVyYVBhcmFtcyQgPSBjb21iaW5lTGF0ZXN0KFtcbiAgICB0aGlzLnN0b3JlLnNlbGVjdCgnY2FtZXJhJyksXG4gICAgdGhpcy5zZWxlY3Qoc2VsZWN0U2xpY2UoWydvcnRob2dyYXBoaWNDYW1lcmEnLCAnbWFrZURlZmF1bHQnXSkpLFxuICBdKS5waXBlKFxuICAgIG1hcCgoW2NhbWVyYSwgeyBvcnRob2dyYXBoaWNDYW1lcmEsIG1ha2VEZWZhdWx0IH1dKSA9PiAoe1xuICAgICAgY2FtZXJhLFxuICAgICAgb3J0aG9ncmFwaGljQ2FtZXJhLFxuICAgICAgbWFrZURlZmF1bHQsXG4gICAgfSkpXG4gICk7XG5cbiAgcmVhZG9ubHkgdm0kOiBPYnNlcnZhYmxlPHtcbiAgICBsZWZ0OiBudW1iZXI7XG4gICAgcmlnaHQ6IG51bWJlcjtcbiAgICB0b3A6IG51bWJlcjtcbiAgICBib3R0b206IG51bWJlcjtcbiAgICBuZWFyPzogbnVtYmVyO1xuICAgIGZhcj86IG51bWJlcjtcbiAgICBvYmplY3RJbnB1dHNDb250cm9sbGVyOiBOZ3RPYmplY3QzZElucHV0c0NvbnRyb2xsZXI7XG4gIH0+ID0gY29tYmluZUxhdGVzdChbXG4gICAgb2YodGhpcy5vYmplY3RJbnB1dHNDb250cm9sbGVyKSxcbiAgICB0aGlzLnN0b3JlLnNlbGVjdCgnc2l6ZScpLFxuICAgIHRoaXMuc2VsZWN0KFxuICAgICAgc2VsZWN0U2xpY2UoWyduZWFyJywgJ2ZhciddKSxcbiAgICAgIHN0YXJ0V2l0aCh7IG5lYXI6IHVuZGVmaW5lZCwgZmFyOiB1bmRlZmluZWQgfSlcbiAgICApLFxuICBdKS5waXBlKFxuICAgIG1hcCgoW29iamVjdElucHV0c0NvbnRyb2xsZXIsIHNpemUsIHsgbmVhciwgZmFyIH1dKSA9PiAoe1xuICAgICAgbGVmdDogc2l6ZS53aWR0aCAvIC0yLFxuICAgICAgcmlnaHQ6IHNpemUud2lkdGggLyAyLFxuICAgICAgdG9wOiBzaXplLmhlaWdodCAvIDIsXG4gICAgICBib3R0b206IHNpemUuaGVpZ2h0IC8gLTIsXG4gICAgICBvYmplY3RJbnB1dHNDb250cm9sbGVyLFxuICAgICAgbmVhcixcbiAgICAgIGZhcixcbiAgICB9KSlcbiAgKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHN0b3JlOiBOZ3RTdG9yZSxcbiAgICBASW5qZWN0KE5HVF9PQkpFQ1RfSU5QVVRTX1dBVENIRURfQ09OVFJPTExFUilcbiAgICBwcml2YXRlIG9iamVjdElucHV0c0NvbnRyb2xsZXI6IE5ndE9iamVjdDNkSW5wdXRzQ29udHJvbGxlclxuICApIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5ob2xkKHRoaXMuI3Byb2plY3RNYXRyaXhQYXJhbXMkLCAoKSA9PiB7XG4gICAgICBjb25zdCB7IG1hbnVhbCwgb3J0aG9ncmFwaGljQ2FtZXJhIH0gPSB0aGlzLmdldCgpO1xuICAgICAgaWYgKG9ydGhvZ3JhcGhpY0NhbWVyYSAmJiAhbWFudWFsKSB7XG4gICAgICAgIG9ydGhvZ3JhcGhpY0NhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLmhvbGRFZmZlY3QoXG4gICAgICB0aGlzLiNjYW1lcmFQYXJhbXMkLFxuICAgICAgKHsgY2FtZXJhLCBvcnRob2dyYXBoaWNDYW1lcmEsIG1ha2VEZWZhdWx0IH0pID0+IHtcbiAgICAgICAgaWYgKG1ha2VEZWZhdWx0ICYmIG9ydGhvZ3JhcGhpY0NhbWVyYSkge1xuICAgICAgICAgIHRoaXMuc3RvcmUuc2V0KHsgY2FtZXJhOiBvcnRob2dyYXBoaWNDYW1lcmEgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgIHRoaXMuc3RvcmUuc2V0KHsgY2FtZXJhIH0pO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICk7XG4gIH1cbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd0LXNvYmEtb3J0aG9ncmFwaGljLWNhbWVyYScsXG4gIHRlbXBsYXRlOiBgXG4gICAgPG5ndC1vcnRob2dyYXBoaWMtY2FtZXJhXG4gICAgICAqbmdJZj1cInZtJCB8IGFzeW5jIGFzIHZtXCJcbiAgICAgIFthcmdzXT1cIlt2bS5sZWZ0LCB2bS5yaWdodCwgdm0udG9wLCB2bS5ib3R0b20sIHZtLm5lYXIsIHZtLmZhcl1cIlxuICAgICAgW29iamVjdDNkSW5wdXRzQ29udHJvbGxlcl09XCJ2bS5vYmplY3RJbnB1dHNDb250cm9sbGVyXCJcbiAgICAgIChyZWFkeSk9XCJvYmplY3QgPSAkZXZlbnRcIlxuICAgID5cbiAgICAgIDxuZy1jb250ZW50PjwvbmctY29udGVudD5cbiAgICA8L25ndC1vcnRob2dyYXBoaWMtY2FtZXJhPlxuICBgLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgcHJvdmlkZXJzOiBbXG4gICAgTkdUX09CSkVDVF9JTlBVVFNfQ09OVFJPTExFUl9QUk9WSURFUixcbiAgICBOZ3RTb2JhT3J0aG9ncmFwaGljQ2FtZXJhU3RvcmUsXG4gICAgeyBwcm92aWRlOiBOZ3RTb2JhRXh0ZW5kZXIsIHVzZUV4aXN0aW5nOiBOZ3RTb2JhT3J0aG9ncmFwaGljQ2FtZXJhIH0sXG4gIF0sXG59KVxuZXhwb3J0IGNsYXNzIE5ndFNvYmFPcnRob2dyYXBoaWNDYW1lcmEgZXh0ZW5kcyBOZ3RTb2JhRXh0ZW5kZXI8VEhSRUUuT3J0aG9ncmFwaGljQ2FtZXJhPiB7XG4gIEBJbnB1dCgpIHNldCBtYWtlRGVmYXVsdChtYWtlRGVmYXVsdDogYm9vbGVhbikge1xuICAgIHRoaXMuc29iYU9ydGhvZ3JhcGhpY0NhbWVyYVN0b3JlLnNldCh7IG1ha2VEZWZhdWx0IH0pO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IG1hbnVhbChtYW51YWw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnNvYmFPcnRob2dyYXBoaWNDYW1lcmFTdG9yZS5zZXQoeyBtYW51YWwgfSk7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgbmVhcihuZWFyOiBudW1iZXIpIHtcbiAgICB0aGlzLnNvYmFPcnRob2dyYXBoaWNDYW1lcmFTdG9yZS5zZXQoeyBuZWFyIH0pO1xuICB9XG5cbiAgQElucHV0KCkgc2V0IGZhcihmYXI6IG51bWJlcikge1xuICAgIHRoaXMuc29iYU9ydGhvZ3JhcGhpY0NhbWVyYVN0b3JlLnNldCh7IGZhciB9KTtcbiAgfVxuXG4gIHJlYWRvbmx5IHZtJCA9IHRoaXMuc29iYU9ydGhvZ3JhcGhpY0NhbWVyYVN0b3JlLnZtJDtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHNvYmFPcnRob2dyYXBoaWNDYW1lcmFTdG9yZTogTmd0U29iYU9ydGhvZ3JhcGhpY0NhbWVyYVN0b3JlXG4gICkge1xuICAgIHN1cGVyKCk7XG4gIH1cbn1cblxuQE5nTW9kdWxlKHtcbiAgZGVjbGFyYXRpb25zOiBbTmd0U29iYU9ydGhvZ3JhcGhpY0NhbWVyYV0sXG4gIGV4cG9ydHM6IFtOZ3RTb2JhT3J0aG9ncmFwaGljQ2FtZXJhLCBOZ3RPYmplY3QzZElucHV0c0NvbnRyb2xsZXJNb2R1bGVdLFxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBOZ3RPcnRob2dyYXBoaWNDYW1lcmFNb2R1bGVdLFxufSlcbmV4cG9ydCBjbGFzcyBOZ3RTb2JhT3J0aG9ncmFwaGljQ2FtZXJhTW9kdWxlIHt9XG4iXX0=