import * as THREE from 'three';
export function shaderMaterial(uniforms, vertexShader, fragmentShader, onInit) {
    return class extends THREE.ShaderMaterial {
        constructor() {
            const entries = Object.entries(uniforms);
            // Create unforms and shaders
            super({
                uniforms: entries.reduce((acc, [name, value]) => {
                    const uniform = THREE.UniformsUtils.clone({ [name]: { value } });
                    return {
                        ...acc,
                        ...uniform,
                    };
                }, {}),
                vertexShader,
                fragmentShader,
            });
            // Create getter/setters
            entries.forEach(([name]) => Object.defineProperty(this, name, {
                get: () => this.uniforms[name].value,
                set: (v) => (this.uniforms[name].value = v),
            }));
            if (onInit)
                onInit(this);
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hhZGVyLW1hdGVyaWFsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvc29iYS9zcmMvbGliL3NoYWRlci1tYXRlcmlhbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUUvQixNQUFNLFVBQVUsY0FBYyxDQUM1QixRQWlCQyxFQUNELFlBQW9CLEVBQ3BCLGNBQXNCLEVBQ3RCLE1BQWtEO0lBRWxELE9BQU8sS0FBTSxTQUFRLEtBQUssQ0FBQyxjQUFjO1FBQ3ZDO1lBQ0UsTUFBTSxPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN6Qyw2QkFBNkI7WUFDN0IsS0FBSyxDQUFDO2dCQUNKLFFBQVEsRUFBRSxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxFQUFFLEVBQUU7b0JBQzlDLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztvQkFDakUsT0FBTzt3QkFDTCxHQUFHLEdBQUc7d0JBQ04sR0FBRyxPQUFPO3FCQUNYLENBQUM7Z0JBQ0osQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDTixZQUFZO2dCQUNaLGNBQWM7YUFDZixDQUFDLENBQUM7WUFDSCx3QkFBd0I7WUFDeEIsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUN6QixNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUU7Z0JBQ2hDLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUs7Z0JBQ3BDLEdBQUcsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7YUFDNUMsQ0FBQyxDQUNILENBQUM7WUFDRixJQUFJLE1BQU07Z0JBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNCLENBQUM7S0FDRixDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFRIUkVFIGZyb20gJ3RocmVlJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNoYWRlck1hdGVyaWFsKFxuICB1bmlmb3Jtczoge1xuICAgIFtuYW1lOiBzdHJpbmddOlxuICAgICAgfCBUSFJFRS5DdWJlVGV4dHVyZVxuICAgICAgfCBUSFJFRS5UZXh0dXJlXG4gICAgICB8IEludDMyQXJyYXlcbiAgICAgIHwgRmxvYXQzMkFycmF5XG4gICAgICB8IFRIUkVFLk1hdHJpeDRcbiAgICAgIHwgVEhSRUUuTWF0cml4M1xuICAgICAgfCBUSFJFRS5RdWF0ZXJuaW9uXG4gICAgICB8IFRIUkVFLlZlY3RvcjRcbiAgICAgIHwgVEhSRUUuVmVjdG9yM1xuICAgICAgfCBUSFJFRS5WZWN0b3IyXG4gICAgICB8IFRIUkVFLkNvbG9yXG4gICAgICB8IG51bWJlclxuICAgICAgfCBib29sZWFuXG4gICAgICB8IEFycmF5PGFueT5cbiAgICAgIHwgbnVsbDtcbiAgfSxcbiAgdmVydGV4U2hhZGVyOiBzdHJpbmcsXG4gIGZyYWdtZW50U2hhZGVyOiBzdHJpbmcsXG4gIG9uSW5pdD86IChtYXRlcmlhbD86IFRIUkVFLlNoYWRlck1hdGVyaWFsKSA9PiB2b2lkXG4pIHtcbiAgcmV0dXJuIGNsYXNzIGV4dGVuZHMgVEhSRUUuU2hhZGVyTWF0ZXJpYWwge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgY29uc3QgZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKHVuaWZvcm1zKTtcbiAgICAgIC8vIENyZWF0ZSB1bmZvcm1zIGFuZCBzaGFkZXJzXG4gICAgICBzdXBlcih7XG4gICAgICAgIHVuaWZvcm1zOiBlbnRyaWVzLnJlZHVjZSgoYWNjLCBbbmFtZSwgdmFsdWVdKSA9PiB7XG4gICAgICAgICAgY29uc3QgdW5pZm9ybSA9IFRIUkVFLlVuaWZvcm1zVXRpbHMuY2xvbmUoeyBbbmFtZV06IHsgdmFsdWUgfSB9KTtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLi4uYWNjLFxuICAgICAgICAgICAgLi4udW5pZm9ybSxcbiAgICAgICAgICB9O1xuICAgICAgICB9LCB7fSksXG4gICAgICAgIHZlcnRleFNoYWRlcixcbiAgICAgICAgZnJhZ21lbnRTaGFkZXIsXG4gICAgICB9KTtcbiAgICAgIC8vIENyZWF0ZSBnZXR0ZXIvc2V0dGVyc1xuICAgICAgZW50cmllcy5mb3JFYWNoKChbbmFtZV0pID0+XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBuYW1lLCB7XG4gICAgICAgICAgZ2V0OiAoKSA9PiB0aGlzLnVuaWZvcm1zW25hbWVdLnZhbHVlLFxuICAgICAgICAgIHNldDogKHYpID0+ICh0aGlzLnVuaWZvcm1zW25hbWVdLnZhbHVlID0gdiksXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgICAgaWYgKG9uSW5pdCkgb25Jbml0KHRoaXMpO1xuICAgIH1cbiAgfTtcbn1cbiJdfQ==