var _NgtSobaText_text;
import { __classPrivateFieldGet, __classPrivateFieldSet } from "tslib";
import { applyProps, NGT_CONTENT_MATERIAL_CONTROLLER_PROVIDER, NGT_CONTENT_MATERIAL_WATCHED_CONTROLLER, NGT_OBJECT_INPUTS_CONTROLLER_PROVIDER, NGT_OBJECT_INPUTS_WATCHED_CONTROLLER, NgtContentMaterialController, NgtContentMaterialControllerModule, NgtLoopService, NgtObject3dInputsController, NgtObject3dInputsControllerModule, NgtSobaExtender, } from '@angular-three/core';
import { NgtPrimitiveModule } from '@angular-three/core/primitive';
import { CommonModule } from '@angular/common';
import { ChangeDetectionStrategy, Component, ElementRef, EventEmitter, Inject, Input, NgModule, NgZone, Output, } from '@angular/core';
import { requestAnimationFrame } from '@rx-angular/cdk/zone-less';
// @ts-ignore
import { Text as TextMeshImpl } from 'troika-three-text';
import * as i0 from "@angular/core";
import * as i1 from "@angular-three/core";
import * as i2 from "@angular/common";
import * as i3 from "@angular-three/core/primitive";
export class NgtSobaText extends NgtSobaExtender {
    constructor(objectInputsController, contentMaterialController, elRef, ngZone, loopService) {
        super();
        this.objectInputsController = objectInputsController;
        this.contentMaterialController = contentMaterialController;
        this.elRef = elRef;
        this.ngZone = ngZone;
        this.loopService = loopService;
        this.anchorX = 'center';
        this.anchorY = 'middle';
        this.sync = new EventEmitter();
        _NgtSobaText_text.set(this, '');
        ngZone.runOutsideAngular(() => {
            this.object = new TextMeshImpl();
        });
    }
    get text() {
        return __classPrivateFieldGet(this, _NgtSobaText_text, "f");
    }
    set text(value) {
        __classPrivateFieldSet(this, _NgtSobaText_text, value.trim(), "f");
    }
    ngOnChanges() {
        this.ngZone.runOutsideAngular(() => {
            if (this.object) {
                this.object.sync(() => {
                    this.loopService.invalidate();
                    if (this.sync.observed) {
                        this.sync.emit(this.object);
                    }
                });
            }
        });
    }
    ngOnInit() {
        requestAnimationFrame(() => {
            this.elRef.nativeElement.childNodes.forEach((childNode) => {
                if (childNode instanceof Text) {
                    this.text += childNode.textContent;
                }
            });
        });
    }
    ngOnDestroy() {
        if (this.object) {
            this.object.dispose();
        }
    }
    onTroikaTextReady(troikaText) {
        requestAnimationFrame(() => {
            troikaText.text = this.text;
            if (this.contentMaterialController.material) {
                troikaText.material = this.contentMaterialController.material;
            }
            applyProps(troikaText, {
                color: this.color,
                fontSize: this.fontSize,
                maxWidth: this.maxWidth,
                lineHeight: this.lineHeight,
                letterSpacing: this.letterSpacing,
                textAlign: this.textAlign,
                font: this.font,
                anchorX: this.anchorX,
                anchorY: this.anchorY,
                clipRect: this.clipRect,
                depthOffset: this.depthOffset,
                direction: this.direction,
                overflowWrap: this.overflowWrap,
                whiteSpace: this.whiteSpace,
                outlineWidth: this.outlineWidth,
                outlineOffsetX: this.outlineOffsetX,
                outlineOffsetY: this.outlineOffsetY,
                outlineBlur: this.outlineBlur,
                outlineColor: this.outlineColor,
                outlineOpacity: this.outlineOpacity,
                strokeWidth: this.strokeWidth,
                strokeColor: this.strokeColor,
                strokeOpacity: this.strokeOpacity,
                fillOpacity: this.fillOpacity,
                debugSDF: this.debugSDF,
            });
        });
    }
}
_NgtSobaText_text = new WeakMap();
NgtSobaText.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaText, deps: [{ token: NGT_OBJECT_INPUTS_WATCHED_CONTROLLER }, { token: NGT_CONTENT_MATERIAL_WATCHED_CONTROLLER }, { token: i0.ElementRef }, { token: i0.NgZone }, { token: i1.NgtLoopService }], target: i0.ɵɵFactoryTarget.Component });
NgtSobaText.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.1", type: NgtSobaText, selector: "ngt-soba-text", inputs: { color: "color", fontSize: "fontSize", maxWidth: "maxWidth", lineHeight: "lineHeight", letterSpacing: "letterSpacing", textAlign: "textAlign", font: "font", anchorX: "anchorX", anchorY: "anchorY", clipRect: "clipRect", depthOffset: "depthOffset", direction: "direction", overflowWrap: "overflowWrap", whiteSpace: "whiteSpace", outlineWidth: "outlineWidth", outlineOffsetX: "outlineOffsetX", outlineOffsetY: "outlineOffsetY", outlineBlur: "outlineBlur", outlineColor: "outlineColor", outlineOpacity: "outlineOpacity", strokeWidth: "strokeWidth", strokeColor: "strokeColor", strokeOpacity: "strokeOpacity", fillOpacity: "fillOpacity", debugSDF: "debugSDF" }, outputs: { sync: "sync" }, providers: [
        NGT_OBJECT_INPUTS_CONTROLLER_PROVIDER,
        NGT_CONTENT_MATERIAL_CONTROLLER_PROVIDER,
        { provide: NgtSobaExtender, useExisting: NgtSobaText },
    ], usesInheritance: true, usesOnChanges: true, ngImport: i0, template: `
    <ng-container *ngIf="object">
      <ngt-primitive
        [object]="$any(object)"
        [object3dInputsController]="objectInputsController"
        (ready)="onTroikaTextReady(object)"
      >
      </ngt-primitive>
    </ng-container>
    <ng-content></ng-content>
  `, isInline: true, directives: [{ type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i1.NgtObject3dController, selector: "    ngt-primitive,    ngt-bone,    ngt-group,    ngt-lod,    ngt-points,    ngt-mesh,    ngt-instanced-mesh,    ngt-skinned-mesh,    ngt-audio,    ngt-positional-audio,    ngt-line,    ngt-line-loop,    ngt-line-segments,    ngt-light-probe,    ngt-ambient-light,    ngt-ambient-light-probe,    ngt-hemisphere-light,    ngt-hemisphere-light-probe,    ngt-directional-light,    ngt-point-light,    ngt-spot-light,    ngt-rect-area-light,    ngt-arrow-helper,    ngt-axes-helper,    ngt-box3-helper,    ngt-grid-helper,    ngt-plane-helper,    ngt-polar-grid-helper,    ngt-sprite,    ngt-camera,    ngt-perspective-camera,    ngt-orthographic-camera,    ngt-array-camera,    ngt-stereo-camera,    ngt-cube-camera  ", exportAs: ["ngtObject3dController"] }, { type: i1.NgtObject3dInputsController, selector: "    ngt-primitive,    ngt-bone,    ngt-group,    ngt-lod,    ngt-points,    ngt-mesh,    ngt-instanced-mesh,    ngt-skinned-mesh,    ngt-audio,    ngt-positional-audio,    ngt-line,    ngt-line-loop,    ngt-line-segments,    ngt-light-probe,    ngt-ambient-light,    ngt-ambient-light-probe,    ngt-hemisphere-light,    ngt-hemisphere-light-probe,    ngt-directional-light,    ngt-point-light,    ngt-spot-light,    ngt-rect-area-light,    ngt-arrow-helper,    ngt-axes-helper,    ngt-box3-helper,    ngt-grid-helper,    ngt-plane-helper,    ngt-polar-grid-helper,    ngt-sprite,    ngt-camera,    ngt-perspective-camera,    ngt-orthographic-camera,    ngt-array-camera,    ngt-stereo-camera,    ngt-cube-camera,    ngt-soba-plane,    ngt-soba-box,    ngt-soba-cylinder,    ngt-soba-cone,    ngt-soba-circle,    ngt-soba-sphere,    ngt-soba-tube,    ngt-soba-torus,    ngt-soba-tetrahedron,    ngt-soba-ring,    ngt-soba-polyhedron,    ngt-soba-octahedron,    ngt-soba-dodecahedron,    ngt-soba-icosahedron,    ngt-soba-extrude,    ngt-soba-lathe,    ngt-soba-torus-knot,    ngt-soba-billboard,    ngt-soba-detailed,    ngt-soba-line,    ngt-soba-quadratic-bezier-line,    ngt-soba-cubic-bezier-line,    ngt-soba-orthographic-camera,    ngt-soba-gizmo-helper,    ngt-soba-gizmo-viewport,    ngt-soba-gizmo-axis-head,    ngt-soba-text  ", inputs: ["name", "position", "rotation", "quaternion", "scale", "color", "userData", "castShadow", "receiveShadow", "visible", "matrixAutoUpdate", "dispose", "raycast", "appendMode", "appendTo", "object3dInputsController"], outputs: ["click", "contextmenu", "dblclick", "pointerup", "pointerdown", "pointerover", "pointerout", "pointerenter", "pointerleave", "pointermove", "pointermissed", "pointercancel", "wheel"], exportAs: ["ngtObject3dInputsController"] }, { type: i3.NgtPrimitive, selector: "ngt-primitive[object]", inputs: ["object"], outputs: ["ready"], exportAs: ["ngtPrimitive"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaText, decorators: [{
            type: Component,
            args: [{
                    selector: 'ngt-soba-text',
                    template: `
    <ng-container *ngIf="object">
      <ngt-primitive
        [object]="$any(object)"
        [object3dInputsController]="objectInputsController"
        (ready)="onTroikaTextReady(object)"
      >
      </ngt-primitive>
    </ng-container>
    <ng-content></ng-content>
  `,
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    providers: [
                        NGT_OBJECT_INPUTS_CONTROLLER_PROVIDER,
                        NGT_CONTENT_MATERIAL_CONTROLLER_PROVIDER,
                        { provide: NgtSobaExtender, useExisting: NgtSobaText },
                    ],
                }]
        }], ctorParameters: function () { return [{ type: i1.NgtObject3dInputsController, decorators: [{
                    type: Inject,
                    args: [NGT_OBJECT_INPUTS_WATCHED_CONTROLLER]
                }] }, { type: i1.NgtContentMaterialController, decorators: [{
                    type: Inject,
                    args: [NGT_CONTENT_MATERIAL_WATCHED_CONTROLLER]
                }] }, { type: i0.ElementRef }, { type: i0.NgZone }, { type: i1.NgtLoopService }]; }, propDecorators: { color: [{
                type: Input
            }], fontSize: [{
                type: Input
            }], maxWidth: [{
                type: Input
            }], lineHeight: [{
                type: Input
            }], letterSpacing: [{
                type: Input
            }], textAlign: [{
                type: Input
            }], font: [{
                type: Input
            }], anchorX: [{
                type: Input
            }], anchorY: [{
                type: Input
            }], clipRect: [{
                type: Input
            }], depthOffset: [{
                type: Input
            }], direction: [{
                type: Input
            }], overflowWrap: [{
                type: Input
            }], whiteSpace: [{
                type: Input
            }], outlineWidth: [{
                type: Input
            }], outlineOffsetX: [{
                type: Input
            }], outlineOffsetY: [{
                type: Input
            }], outlineBlur: [{
                type: Input
            }], outlineColor: [{
                type: Input
            }], outlineOpacity: [{
                type: Input
            }], strokeWidth: [{
                type: Input
            }], strokeColor: [{
                type: Input
            }], strokeOpacity: [{
                type: Input
            }], fillOpacity: [{
                type: Input
            }], debugSDF: [{
                type: Input
            }], sync: [{
                type: Output
            }] } });
export class NgtSobaTextModule {
}
NgtSobaTextModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaTextModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });
NgtSobaTextModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaTextModule, declarations: [NgtSobaText], imports: [CommonModule, NgtPrimitiveModule], exports: [NgtSobaText, NgtObject3dInputsControllerModule,
        NgtContentMaterialControllerModule] });
NgtSobaTextModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaTextModule, imports: [[CommonModule, NgtPrimitiveModule], NgtObject3dInputsControllerModule,
        NgtContentMaterialControllerModule] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.1", ngImport: i0, type: NgtSobaTextModule, decorators: [{
            type: NgModule,
            args: [{
                    declarations: [NgtSobaText],
                    exports: [
                        NgtSobaText,
                        NgtObject3dInputsControllerModule,
                        NgtContentMaterialControllerModule,
                    ],
                    imports: [CommonModule, NgtPrimitiveModule],
                }]
        }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9zb2JhL2Fic3RyYWN0aW9ucy9zcmMvdGV4dC90ZXh0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE9BQU8sRUFDTCxVQUFVLEVBQ1Ysd0NBQXdDLEVBQ3hDLHVDQUF1QyxFQUN2QyxxQ0FBcUMsRUFDckMsb0NBQW9DLEVBRXBDLDRCQUE0QixFQUM1QixrQ0FBa0MsRUFDbEMsY0FBYyxFQUNkLDJCQUEyQixFQUMzQixpQ0FBaUMsRUFDakMsZUFBZSxHQUVoQixNQUFNLHFCQUFxQixDQUFDO0FBQzdCLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQ25FLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMvQyxPQUFPLEVBQ0wsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLE1BQU0sRUFDTixLQUFLLEVBQ0wsUUFBUSxFQUNSLE1BQU0sRUFJTixNQUFNLEdBQ1AsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDbEUsYUFBYTtBQUNiLE9BQU8sRUFBRSxJQUFJLElBQUksWUFBWSxFQUFFLE1BQU0sbUJBQW1CLENBQUM7Ozs7O0FBc0J6RCxNQUFNLE9BQU8sV0FDWCxTQUFRLGVBQTZCO0lBOENyQyxZQUVTLHNCQUFtRCxFQUVsRCx5QkFBdUQsRUFDdkQsS0FBOEIsRUFDOUIsTUFBYyxFQUNkLFdBQTJCO1FBRW5DLEtBQUssRUFBRSxDQUFDO1FBUEQsMkJBQXNCLEdBQXRCLHNCQUFzQixDQUE2QjtRQUVsRCw4QkFBeUIsR0FBekIseUJBQXlCLENBQThCO1FBQ3ZELFVBQUssR0FBTCxLQUFLLENBQXlCO1FBQzlCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxn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cHBseVByb3BzLFxuICBOR1RfQ09OVEVOVF9NQVRFUklBTF9DT05UUk9MTEVSX1BST1ZJREVSLFxuICBOR1RfQ09OVEVOVF9NQVRFUklBTF9XQVRDSEVEX0NPTlRST0xMRVIsXG4gIE5HVF9PQkpFQ1RfSU5QVVRTX0NPTlRST0xMRVJfUFJPVklERVIsXG4gIE5HVF9PQkpFQ1RfSU5QVVRTX1dBVENIRURfQ09OVFJPTExFUixcbiAgTmd0Q29sb3IsXG4gIE5ndENvbnRlbnRNYXRlcmlhbENvbnRyb2xsZXIsXG4gIE5ndENvbnRlbnRNYXRlcmlhbENvbnRyb2xsZXJNb2R1bGUsXG4gIE5ndExvb3BTZXJ2aWNlLFxuICBOZ3RPYmplY3QzZElucHV0c0NvbnRyb2xsZXIsXG4gIE5ndE9iamVjdDNkSW5wdXRzQ29udHJvbGxlck1vZHVsZSxcbiAgTmd0U29iYUV4dGVuZGVyLFxuICBOZ3RWZWN0b3I0LFxufSBmcm9tICdAYW5ndWxhci10aHJlZS9jb3JlJztcbmltcG9ydCB7IE5ndFByaW1pdGl2ZU1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyLXRocmVlL2NvcmUvcHJpbWl0aXZlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneSxcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIEluamVjdCxcbiAgSW5wdXQsXG4gIE5nTW9kdWxlLFxuICBOZ1pvbmUsXG4gIE9uQ2hhbmdlcyxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfSBmcm9tICdAcngtYW5ndWxhci9jZGsvem9uZS1sZXNzJztcbi8vIEB0cy1pZ25vcmVcbmltcG9ydCB7IFRleHQgYXMgVGV4dE1lc2hJbXBsIH0gZnJvbSAndHJvaWthLXRocmVlLXRleHQnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduZ3Qtc29iYS10ZXh0JyxcbiAgdGVtcGxhdGU6IGBcbiAgICA8bmctY29udGFpbmVyICpuZ0lmPVwib2JqZWN0XCI+XG4gICAgICA8bmd0LXByaW1pdGl2ZVxuICAgICAgICBbb2JqZWN0XT1cIiRhbnkob2JqZWN0KVwiXG4gICAgICAgIFtvYmplY3QzZElucHV0c0NvbnRyb2xsZXJdPVwib2JqZWN0SW5wdXRzQ29udHJvbGxlclwiXG4gICAgICAgIChyZWFkeSk9XCJvblRyb2lrYVRleHRSZWFkeShvYmplY3QpXCJcbiAgICAgID5cbiAgICAgIDwvbmd0LXByaW1pdGl2ZT5cbiAgICA8L25nLWNvbnRhaW5lcj5cbiAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gIGAsXG4gIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICBwcm92aWRlcnM6IFtcbiAgICBOR1RfT0JKRUNUX0lOUFVUU19DT05UUk9MTEVSX1BST1ZJREVSLFxuICAgIE5HVF9DT05URU5UX01BVEVSSUFMX0NPTlRST0xMRVJfUFJPVklERVIsXG4gICAgeyBwcm92aWRlOiBOZ3RTb2JhRXh0ZW5kZXIsIHVzZUV4aXN0aW5nOiBOZ3RTb2JhVGV4dCB9LFxuICBdLFxufSlcbmV4cG9ydCBjbGFzcyBOZ3RTb2JhVGV4dFxuICBleHRlbmRzIE5ndFNvYmFFeHRlbmRlcjxUZXh0TWVzaEltcGw+XG4gIGltcGxlbWVudHMgT25Jbml0LCBPbkNoYW5nZXMsIE9uRGVzdHJveVxue1xuICBASW5wdXQoKSBjb2xvcj86IE5ndENvbG9yO1xuICBASW5wdXQoKSBmb250U2l6ZT86IG51bWJlcjtcbiAgQElucHV0KCkgbWF4V2lkdGg/OiBudW1iZXI7XG4gIEBJbnB1dCgpIGxpbmVIZWlnaHQ/OiBudW1iZXI7XG4gIEBJbnB1dCgpIGxldHRlclNwYWNpbmc/OiBudW1iZXI7XG4gIEBJbnB1dCgpIHRleHRBbGlnbj86ICdsZWZ0JyB8ICdyaWdodCcgfCAnY2VudGVyJyB8ICdqdXN0aWZ5JztcbiAgQElucHV0KCkgZm9udD86IHN0cmluZztcbiAgQElucHV0KCkgYW5jaG9yWDogbnVtYmVyIHwgJ2xlZnQnIHwgJ2NlbnRlcicgfCAncmlnaHQnID0gJ2NlbnRlcic7XG4gIEBJbnB1dCgpIGFuY2hvclk6XG4gICAgfCBudW1iZXJcbiAgICB8ICd0b3AnXG4gICAgfCAndG9wLWJhc2VsaW5lJ1xuICAgIHwgJ21pZGRsZSdcbiAgICB8ICdib3R0b20tYmFzZWxpbmUnXG4gICAgfCAnYm90dG9tJyA9ICdtaWRkbGUnO1xuICBASW5wdXQoKSBjbGlwUmVjdD86IE5ndFZlY3RvcjQ7XG4gIEBJbnB1dCgpIGRlcHRoT2Zmc2V0PzogbnVtYmVyO1xuICBASW5wdXQoKSBkaXJlY3Rpb24/OiAnYXV0bycgfCAnbHRyJyB8ICdydGwnO1xuICBASW5wdXQoKSBvdmVyZmxvd1dyYXA/OiAnbm9ybWFsJyB8ICdicmVhay13b3JkJztcbiAgQElucHV0KCkgd2hpdGVTcGFjZT86ICdub3JtYWwnIHwgJ292ZXJmbG93V3JhcCcgfCAnb3ZlcmZsb3dXcmFwJztcbiAgQElucHV0KCkgb3V0bGluZVdpZHRoPzogbnVtYmVyIHwgc3RyaW5nO1xuICBASW5wdXQoKSBvdXRsaW5lT2Zmc2V0WD86IG51bWJlciB8IHN0cmluZztcbiAgQElucHV0KCkgb3V0bGluZU9mZnNldFk/OiBudW1iZXIgfCBzdHJpbmc7XG4gIEBJbnB1dCgpIG91dGxpbmVCbHVyPzogbnVtYmVyIHwgc3RyaW5nO1xuICBASW5wdXQoKSBvdXRsaW5lQ29sb3I/OiBOZ3RDb2xvcjtcbiAgQElucHV0KCkgb3V0bGluZU9wYWNpdHk/OiBudW1iZXI7XG4gIEBJbnB1dCgpIHN0cm9rZVdpZHRoPzogbnVtYmVyIHwgc3RyaW5nO1xuICBASW5wdXQoKSBzdHJva2VDb2xvcj86IE5ndENvbG9yO1xuICBASW5wdXQoKSBzdHJva2VPcGFjaXR5PzogbnVtYmVyO1xuICBASW5wdXQoKSBmaWxsT3BhY2l0eT86IG51bWJlcjtcbiAgQElucHV0KCkgZGVidWdTREY/OiBib29sZWFuO1xuXG4gIEBPdXRwdXQoKSBzeW5jID0gbmV3IEV2ZW50RW1pdHRlcjxUZXh0TWVzaEltcGw+KCk7XG5cbiAgI3RleHQgPSAnJztcbiAgZ2V0IHRleHQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy4jdGV4dDtcbiAgfVxuXG4gIHNldCB0ZXh0KHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLiN0ZXh0ID0gdmFsdWUudHJpbSgpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdChOR1RfT0JKRUNUX0lOUFVUU19XQVRDSEVEX0NPTlRST0xMRVIpXG4gICAgcHVibGljIG9iamVjdElucHV0c0NvbnRyb2xsZXI6IE5ndE9iamVjdDNkSW5wdXRzQ29udHJvbGxlcixcbiAgICBASW5qZWN0KE5HVF9DT05URU5UX01BVEVSSUFMX1dBVENIRURfQ09OVFJPTExFUilcbiAgICBwcml2YXRlIGNvbnRlbnRNYXRlcmlhbENvbnRyb2xsZXI6IE5ndENvbnRlbnRNYXRlcmlhbENvbnRyb2xsZXIsXG4gICAgcHJpdmF0ZSBlbFJlZjogRWxlbWVudFJlZjxIVE1MRWxlbWVudD4sXG4gICAgcHJpdmF0ZSBuZ1pvbmU6IE5nWm9uZSxcbiAgICBwcml2YXRlIGxvb3BTZXJ2aWNlOiBOZ3RMb29wU2VydmljZVxuICApIHtcbiAgICBzdXBlcigpO1xuICAgIG5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICB0aGlzLm9iamVjdCA9IG5ldyBUZXh0TWVzaEltcGwoKTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKCkge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLm9iamVjdCkge1xuICAgICAgICB0aGlzLm9iamVjdC5zeW5jKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmxvb3BTZXJ2aWNlLmludmFsaWRhdGUoKTtcbiAgICAgICAgICBpZiAodGhpcy5zeW5jLm9ic2VydmVkKSB7XG4gICAgICAgICAgICB0aGlzLnN5bmMuZW1pdCh0aGlzLm9iamVjdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0aGlzLmVsUmVmLm5hdGl2ZUVsZW1lbnQuY2hpbGROb2Rlcy5mb3JFYWNoKChjaGlsZE5vZGUpID0+IHtcbiAgICAgICAgaWYgKGNoaWxkTm9kZSBpbnN0YW5jZW9mIFRleHQpIHtcbiAgICAgICAgICB0aGlzLnRleHQgKz0gY2hpbGROb2RlLnRleHRDb250ZW50O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIGlmICh0aGlzLm9iamVjdCkge1xuICAgICAgdGhpcy5vYmplY3QuZGlzcG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIG9uVHJvaWthVGV4dFJlYWR5KHRyb2lrYVRleHQ6IFRleHRNZXNoSW1wbCkge1xuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICB0cm9pa2FUZXh0LnRleHQgPSB0aGlzLnRleHQ7XG4gICAgICBpZiAodGhpcy5jb250ZW50TWF0ZXJpYWxDb250cm9sbGVyLm1hdGVyaWFsKSB7XG4gICAgICAgIHRyb2lrYVRleHQubWF0ZXJpYWwgPSB0aGlzLmNvbnRlbnRNYXRlcmlhbENvbnRyb2xsZXIubWF0ZXJpYWw7XG4gICAgICB9XG4gICAgICBhcHBseVByb3BzKHRyb2lrYVRleHQsIHtcbiAgICAgICAgY29sb3I6IHRoaXMuY29sb3IsXG4gICAgICAgIGZvbnRTaXplOiB0aGlzLmZvbnRTaXplLFxuICAgICAgICBtYXhXaWR0aDogdGhpcy5tYXhXaWR0aCxcbiAgICAgICAgbGluZUhlaWdodDogdGhpcy5saW5lSGVpZ2h0LFxuICAgICAgICBsZXR0ZXJTcGFjaW5nOiB0aGlzLmxldHRlclNwYWNpbmcsXG4gICAgICAgIHRleHRBbGlnbjogdGhpcy50ZXh0QWxpZ24sXG4gICAgICAgIGZvbnQ6IHRoaXMuZm9udCxcbiAgICAgICAgYW5jaG9yWDogdGhpcy5hbmNob3JYLFxuICAgICAgICBhbmNob3JZOiB0aGlzLmFuY2hvclksXG4gICAgICAgIGNsaXBSZWN0OiB0aGlzLmNsaXBSZWN0LFxuICAgICAgICBkZXB0aE9mZnNldDogdGhpcy5kZXB0aE9mZnNldCxcbiAgICAgICAgZGlyZWN0aW9uOiB0aGlzLmRpcmVjdGlvbixcbiAgICAgICAgb3ZlcmZsb3dXcmFwOiB0aGlzLm92ZXJmbG93V3JhcCxcbiAgICAgICAgd2hpdGVTcGFjZTogdGhpcy53aGl0ZVNwYWNlLFxuICAgICAgICBvdXRsaW5lV2lkdGg6IHRoaXMub3V0bGluZVdpZHRoLFxuICAgICAgICBvdXRsaW5lT2Zmc2V0WDogdGhpcy5vdXRsaW5lT2Zmc2V0WCxcbiAgICAgICAgb3V0bGluZU9mZnNldFk6IHRoaXMub3V0bGluZU9mZnNldFksXG4gICAgICAgIG91dGxpbmVCbHVyOiB0aGlzLm91dGxpbmVCbHVyLFxuICAgICAgICBvdXRsaW5lQ29sb3I6IHRoaXMub3V0bGluZUNvbG9yLFxuICAgICAgICBvdXRsaW5lT3BhY2l0eTogdGhpcy5vdXRsaW5lT3BhY2l0eSxcbiAgICAgICAgc3Ryb2tlV2lkdGg6IHRoaXMuc3Ryb2tlV2lkdGgsXG4gICAgICAgIHN0cm9rZUNvbG9yOiB0aGlzLnN0cm9rZUNvbG9yLFxuICAgICAgICBzdHJva2VPcGFjaXR5OiB0aGlzLnN0cm9rZU9wYWNpdHksXG4gICAgICAgIGZpbGxPcGFjaXR5OiB0aGlzLmZpbGxPcGFjaXR5LFxuICAgICAgICBkZWJ1Z1NERjogdGhpcy5kZWJ1Z1NERixcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5cbkBOZ01vZHVsZSh7XG4gIGRlY2xhcmF0aW9uczogW05ndFNvYmFUZXh0XSxcbiAgZXhwb3J0czogW1xuICAgIE5ndFNvYmFUZXh0LFxuICAgIE5ndE9iamVjdDNkSW5wdXRzQ29udHJvbGxlck1vZHVsZSxcbiAgICBOZ3RDb250ZW50TWF0ZXJpYWxDb250cm9sbGVyTW9kdWxlLFxuICBdLFxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBOZ3RQcmltaXRpdmVNb2R1bGVdLFxufSlcbmV4cG9ydCBjbGFzcyBOZ3RTb2JhVGV4dE1vZHVsZSB7fVxuIl19