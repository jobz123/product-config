{"version":3,"file":"angular-three-soba-controls.mjs","sources":["../../../../packages/soba/controls/src/lib/orbit-controls/orbit-controls.directive.ts","../../../../packages/soba/controls/src/lib/fly-controls/fly-controls.directive.ts","../../../../packages/soba/controls/src/lib/first-person-controls/first-person-controls.directive.ts","../../../../packages/soba/controls/src/angular-three-soba-controls.ts"],"sourcesContent":["import {\n  EnhancedRxState,\n  makeVector3,\n  NgtAnimationFrameStore,\n  NgtEventsStore,\n  NgtLoopService,\n  NgtPerformanceStore,\n  NgtStore,\n  NgtVector3,\n} from '@angular-three/core';\nimport {\n  Directive,\n  EventEmitter,\n  Input,\n  NgModule,\n  NgZone,\n  OnInit,\n  Output,\n} from '@angular/core';\nimport { selectSlice } from '@rx-angular/state';\nimport { of, switchMap } from 'rxjs';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three-stdlib/controls/OrbitControls';\n\nexport interface NgtSobaOrbitControlsState {\n  enableDamping: boolean;\n  makeDefault: boolean;\n  regress: boolean;\n  controls: OrbitControls;\n  camera?: THREE.Camera;\n  domElement?: HTMLElement;\n  target?: NgtVector3;\n}\n\n@Directive({\n  selector: 'ngt-soba-orbit-controls',\n  exportAs: 'ngtSobaOrbitControls',\n})\nexport class NgtSobaOrbitControls\n  extends EnhancedRxState<NgtSobaOrbitControlsState>\n  implements OnInit\n{\n  @Input() set target(v: NgtVector3) {\n    this.set({ target: v });\n  }\n\n  @Input() set camera(v: THREE.Camera) {\n    this.set({ camera: v });\n  }\n\n  @Input() set domElement(v: HTMLElement) {\n    this.set({ domElement: v });\n  }\n\n  @Input() set regress(v: boolean) {\n    this.set({ regress: v });\n  }\n\n  @Input() set enableDamping(v: boolean) {\n    this.set({ enableDamping: v });\n  }\n\n  @Input() set makeDefault(v: boolean) {\n    this.set({ makeDefault: v });\n  }\n\n  @Output() ready = this.select('controls');\n  @Output() change = new EventEmitter<THREE.Event>();\n  @Output() start = new EventEmitter<THREE.Event>();\n  @Output() end = new EventEmitter<THREE.Event>();\n\n  #controlsEventsChanges$ = this.select(\n    selectSlice(['regress', 'controls', 'domElement'])\n  );\n\n  #makeDefaultParams$ = this.select(selectSlice(['makeDefault', 'controls']));\n  #controlsTargetParams$ = this.select(selectSlice(['target', 'controls']));\n\n  constructor(\n    private loopService: NgtLoopService,\n    private store: NgtStore,\n    private eventsStore: NgtEventsStore,\n    private animationFrameStore: NgtAnimationFrameStore,\n    private performanceStore: NgtPerformanceStore,\n    private ngZone: NgZone\n  ) {\n    super();\n    this.set({\n      target: undefined,\n      regress: false,\n      enableDamping: true,\n      makeDefault: false,\n      camera: undefined,\n      domElement: undefined,\n    });\n  }\n\n  ngOnInit() {\n    this.connect('camera', this.store.select('camera'));\n    this.connect(\n      'domElement',\n      this.eventsStore.select('connected').pipe(\n        switchMap((connected) => {\n          if (typeof connected !== 'boolean') return of(connected);\n          return this.store.select('renderer', 'domElement');\n        })\n      )\n    );\n\n    this.holdEffect(this.select('controls'), (controls) => {\n      let animationUuid: string;\n      if (controls.enabled) {\n        animationUuid = this.animationFrameStore.register({\n          callback: () => {\n            controls.update();\n          },\n        });\n      }\n      return () => {\n        this.animationFrameStore.actions.unsubscriberUuid(animationUuid);\n      };\n    });\n\n    this.hold(this.select('camera'), (camera) => {\n      const enableDamping = this.get('enableDamping');\n      if (camera) {\n        const controls = new OrbitControls(camera);\n        controls.enableDamping = enableDamping;\n        this.set({ controls });\n      }\n    });\n\n    this.hold(this.#controlsTargetParams$, ({ controls, target }) => {\n      if (controls) {\n        const vector3Target = makeVector3(target);\n        if (vector3Target) {\n          controls.target = vector3Target;\n        }\n      }\n    });\n\n    this.holdEffect(\n      this.#controlsEventsChanges$,\n      ({ controls, regress, domElement }) => {\n        return this.ngZone.runOutsideAngular(() => {\n          const changeCallback: (e: THREE.Event) => void = (e) => {\n            this.loopService.invalidate();\n            if (regress) {\n              this.performanceStore.regress();\n            }\n\n            if (this.change.observed) {\n              this.change.emit(e);\n            }\n          };\n          let startCallback: (e: THREE.Event) => void;\n          let endCallback: (e: THREE.Event) => void;\n\n          if (domElement) {\n            controls.connect(domElement);\n          }\n\n          controls.addEventListener('change', changeCallback);\n\n          if (this.start.observed) {\n            startCallback = (event: THREE.Event) => {\n              this.start.emit(event);\n            };\n            controls.addEventListener('start', startCallback);\n          }\n\n          if (this.end.observed) {\n            endCallback = (event: THREE.Event) => {\n              this.end.emit(event);\n            };\n            controls.addEventListener('end', endCallback);\n          }\n\n          return () => {\n            controls.removeEventListener('change', changeCallback);\n            if (endCallback) controls.removeEventListener('end', endCallback);\n            if (startCallback)\n              controls.removeEventListener('start', startCallback);\n            controls.dispose();\n          };\n        });\n      }\n    );\n\n    this.holdEffect(this.#makeDefaultParams$, ({ controls, makeDefault }) => {\n      const oldControls = this.store.get('controls');\n      if (makeDefault) {\n        this.store.set({ controls });\n      }\n\n      return () => {\n        this.store.set({ controls: oldControls });\n      };\n    });\n  }\n\n  get controls() {\n    return (this.store.get('controls') ||\n      this.get('controls')) as OrbitControls;\n  }\n}\n\n@NgModule({\n  declarations: [NgtSobaOrbitControls],\n  exports: [NgtSobaOrbitControls],\n})\nexport class NgtSobaOrbitControlsModule {}\n","import {\n  EnhancedRxState,\n  NgtAnimationFrameStore,\n  NgtLoopService,\n  NgtStore,\n} from '@angular-three/core';\nimport {\n  Directive,\n  EventEmitter,\n  NgModule,\n  NgZone,\n  OnInit,\n  Output,\n} from '@angular/core';\nimport { selectSlice } from '@rx-angular/state';\nimport * as THREE from 'three';\nimport { FlyControls } from 'three-stdlib';\n\ninterface NgtSobaFlyControlsState {\n  controls: FlyControls;\n}\n\n@Directive({\n  selector: 'ngt-soba-fly-controls',\n  exportAs: 'ngtSobaFlyControls',\n})\nexport class NgtSobaFlyControls\n  extends EnhancedRxState<NgtSobaFlyControlsState>\n  implements OnInit\n{\n  @Output() ready = this.select('controls');\n  @Output() change = new EventEmitter<THREE.Event>();\n\n  constructor(\n    private store: NgtStore,\n    private loopService: NgtLoopService,\n    private animationFrameStore: NgtAnimationFrameStore,\n    private ngZone: NgZone\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n    this.holdEffect(this.select('controls'), (controls) => {\n      const callback = (e: THREE.Event) => {\n        this.loopService.invalidate();\n        if (this.change.observed) {\n          this.change.emit(e);\n        }\n      };\n\n      controls.addEventListener('change', callback);\n\n      return () => {\n        controls.removeEventListener('change', callback);\n      };\n    });\n\n    this.hold(\n      this.store.select(selectSlice(['camera', 'renderer'])),\n      ({ renderer, camera }) => {\n        this.ngZone.runOutsideAngular(() => {\n          if (camera && renderer) {\n            this.set({\n              controls: new FlyControls(camera, renderer.domElement),\n            });\n          }\n        });\n      }\n    );\n\n    this.holdEffect(this.select('controls'), (controls) => {\n      const animationUuid = this.animationFrameStore.register({\n        callback: ({ delta }) => {\n          controls.update(delta);\n        },\n      });\n\n      return () => {\n        this.animationFrameStore.actions.unsubscriberUuid(animationUuid);\n      };\n    });\n  }\n\n  get controls() {\n    return this.get('controls') as FlyControls;\n  }\n}\n\n@NgModule({\n  declarations: [NgtSobaFlyControls],\n  exports: [NgtSobaFlyControls],\n})\nexport class NgtSobaFlyControlsModule {}\n","import {\n  EnhancedRxState,\n  NgtAnimationFrameStore,\n  NgtStore,\n} from '@angular-three/core';\nimport { Directive, NgModule, NgZone, OnInit, Output } from '@angular/core';\nimport { selectSlice } from '@rx-angular/state';\nimport { FirstPersonControls } from 'three-stdlib';\n\ninterface NgtSobaFirstPersonControlsState {\n  controls: FirstPersonControls;\n}\n\n@Directive({\n  selector: 'ngt-soba-first-person-controls',\n  exportAs: 'ngtSobaFirstPersonControls',\n})\nexport class NgtSobaFirstPersonControls\n  extends EnhancedRxState<NgtSobaFirstPersonControlsState>\n  implements OnInit\n{\n  @Output() ready = this.select('controls');\n\n  constructor(\n    private store: NgtStore,\n    private animationFrameStore: NgtAnimationFrameStore,\n    private ngZone: NgZone\n  ) {\n    super();\n  }\n\n  ngOnInit() {\n    this.hold(\n      this.store.select(selectSlice(['camera', 'renderer'])),\n      ({ renderer, camera }) => {\n        this.ngZone.runOutsideAngular(() => {\n          if (camera && renderer) {\n            this.set({\n              controls: new FirstPersonControls(camera, renderer.domElement),\n            });\n          }\n        });\n      }\n    );\n\n    this.holdEffect(this.select('controls'), (controls) => {\n      const animationUuid = this.animationFrameStore.register({\n        callback: ({ delta }) => {\n          controls.update(delta);\n        },\n      });\n\n      return () => {\n        this.animationFrameStore.actions.unsubscriberUuid(animationUuid);\n      };\n    });\n  }\n\n  get controls() {\n    return this.get('controls') as FirstPersonControls;\n  }\n}\n\n@NgModule({\n  declarations: [NgtSobaFirstPersonControls],\n  exports: [NgtSobaFirstPersonControls],\n})\nexport class NgtSobaFirstPersonControlsModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}